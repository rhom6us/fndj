{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AASA,MAAM,UAAU,KAAK;IACnB,MAAM,MAAM,GAAG;QACb,CAAC,MAAM,CAAC,WAAW,CAAC,EAAE,OAAO;KACT,CAAC;IAEvB,MAAM,CAAC,OAAO,GAAG,IAAI,OAAO,CAAI,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QAClD,MAAM,CAAC,OAAO,GAAG,CAAC,KAAyB,EAAc,EAAE;YACzD,OAAO,CAAC,KAAK,CAAC,CAAC;YACf,OAAO,MAAM,CAAC,OAAO,CAAC;QACxB,CAAC,CAAC;QACF,MAAM,CAAC,MAAM,GAAG,CAAC,MAAW,EAAc,EAAE;YAC1C,MAAM,CAAC,MAAM,CAAC,CAAC;YACf,OAAO,MAAM,CAAC,OAAO,CAAC;QACxB,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;AAC/B,CAAC;AAGD,WAAiB,KAAK;IAGpB,SAAgB,OAAO,CAAC,KAAW;QACjC,OAAO,KAAK,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;IAFe,aAAO,UAEtB,CAAA;IAGD,SAAgB,MAAM,CAAC,MAAY;QACjC,OAAO,KAAK,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IAChC,CAAC;IAFe,YAAM,SAErB,CAAA;AACH,CAAC,EAXgB,KAAK,KAAL,KAAK,QAWrB","sourcesContent":["\ntype Mutable<T> = { -readonly [P in keyof T]: T[P] };\n\nexport interface defer<T = void> {\n  readonly [Symbol.toStringTag]: 'defer';\n  readonly resolve: (value: T | PromiseLike<T>) => Promise<T>;\n  readonly reject: (reason?: any) => Promise<T>;\n  readonly promise: Promise<T>;\n}\nexport function defer<T = void>(): defer<T> {\n  const result = {\n    [Symbol.toStringTag]: 'defer'\n  } as Mutable<defer<T>>;\n\n  result.promise = new Promise<T>((resolve, reject) => {\n    result.resolve = (value: T | PromiseLike<T>): Promise<T> => {\n      resolve(value);\n      return result.promise;\n    };\n    result.reject = (reason: any): Promise<T> => {\n      reject(reason);\n      return result.promise;\n    };\n  });\n\n  return Object.freeze(result);\n}\n\n\nexport namespace defer {\n  export function resolve(): defer<void>;\n  export function resolve<T>(value: T): defer<T>;\n  export function resolve(value?: any): any {\n    return defer().resolve(value);\n  }\n  export function reject(reason?: any): defer<void>;\n  export function reject<T>(reason?: any): defer<T>;\n  export function reject(reason?: any): any {\n    return defer().reject(reason);\n  }\n}\n"]}