{"version":3,"file":"LogoutButton.js","sourceRoot":"","sources":["../src/LogoutButton.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,QAAQ,EAAc,MAAM,eAAe,CAAC;AACrD,OAAO,EAAE,UAAU,EAAE,MAAM,gBAAgB,CAAC;AAC5C,OAAO,KAAK,EAAE,EAAE,WAAW,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AAGhE,MAAM,UAAU,YAAY,CAAC,KAAyH;IAElJ,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;IAEpF,IAAI,CAAC,KAAK,EAAE;QACR,OAAO,yCAAK,CAAC;KAChB;IACD,OAAO,oBAAC,qBAAqB,OAAK,KAAK,EAAE,KAAK,EAAE,KAAM,GAAI,CAAC;AAC/D,CAAC;AAGD,SAAS,qBAAqB,CAAC,EAAE,KAAK,EAAE,GAAG,KAAK,EAAsH;IAClK,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC;IACrE,SAAS,CAAC,GAAG,EAAE;QACX,aAAa,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC;QACtC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IAC3C,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;IACZ,MAAM,EAAE,GAAG,WAAW,CAAC,CAAC,CAA6D,EAAE,EAAE;QACrF,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,CAAC,CAAC,CAAC,kBAAkB,EAAE,EAAE;YACzB,KAAK,CAAC,OAAO,EAAE,CAAC;SACnB;IACL,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;IAEnB,IAAI,CAAC,UAAU,EAAE;QAEb,OAAO,yCAAK,CAAC;KAChB;IAED,OAAO,gCAAQ,IAAI,EAAC,QAAQ,KAAK,KAAK,EAAE,OAAO,EAAE,EAAE,aAAkB,CAAC;AAC1E,CAAC","sourcesContent":["import { getAuth2, GoogleAuth } from '@rhombus/gapi';\r\nimport { usePromise } from '@rhombus/react';\r\nimport React, { useCallback, useEffect, useState } from 'react';\r\n\r\n\r\nexport function LogoutButton(props: { clientId?: string; } & React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement>) {\r\n\r\n    const [ready, auth2] = usePromise(() => getAuth2(props.clientId), [props.clientId]);\r\n\r\n    if (!ready) {\r\n        return <></>;\r\n    }\r\n    return <LogoutButton_Internal {...props} auth2={auth2!} />;\r\n}\r\n\r\n\r\nfunction LogoutButton_Internal({ auth2, ...props }: { auth2: GoogleAuth; } & React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement>) {\r\n    const [isLoggedIn, setIsLoggedIn] = useState(auth2.isSignedIn.get());\r\n    useEffect(() => {\r\n        setIsLoggedIn(auth2.isSignedIn.get());\r\n        auth2.isSignedIn.listen(setIsLoggedIn);\r\n    }, [auth2]);\r\n    const cb = useCallback((e: React.MouseEvent<HTMLButtonElement, globalThis.MouseEvent>) => {\r\n        props.onClick?.(e);\r\n        if (!e.isDefaultPrevented()) {\r\n            auth2.signOut();\r\n        }\r\n    }, [auth2, props]);\r\n\r\n    if (!isLoggedIn) {\r\n\r\n        return <></>;\r\n    }\r\n\r\n    return <button type=\"button\" {...props} onClick={cb} >Logout</button>;\r\n}\r\n"]}