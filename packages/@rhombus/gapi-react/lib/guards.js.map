{"version":3,"file":"guards.js","sourceRoot":"","sources":["../src/guards.tsx"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,EAAiB,IAAI,EAA2B,MAAM,OAAO,CAAC;AAG5E,MAAM,UAAU,YAAY,CAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAA2H;IAC1L,IAAI,SAAS,CAAC,KAAK,CAAC,EAAE;QAClB,OAAO,0CAAG,MAAM,CAAC,KAAK,CAAC,CAAI,CAAC;KAC/B;IAED,OAAO,0CAAG,QAAQ,CAAI,CAAC;AAC3B,CAAC;AAoCD,2FAA2F;AAC3F,MAAM,UAAU,QAAQ,CAA0B,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,KAAK,EAAgH;IACzM,MAAM,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,KAAY,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;IAClE,IAAI,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;QACpC,OAAO,0CAAG,QAAQ,CAAI,CAAC;KAC1B;IACD,OAAO,oBAAC,KAAK,OAAK,KAAiB,GAAI,CAAC;AAC5C,CAAC;AACD,MAAM,UAAU,YAAY,CAAgC,MAAwB,EAAE,KAAc;IAChG,OAAO,IAAI,CAAC,SAAS,OAAO,CAAC,CAAyB;QAClD,OAAO,oBAAC,MAAM,OAAK,EAAE,GAAG,KAAK,EAAE,GAAG,CAAC,EAAc,GAAI,CAAC;IAC1D,CAAC,CAAC,CAAC;AACP,CAAC;AACD,MAAM,UAAU,SAAS,CAAI,KAA2B;IACpD,OAAO,KAAK,IAAI,IAAI,CAAC;AACzB,CAAC;AAGD,0KAA0K;AAC1K,mDAAmD;AACnD,mBAAmB;AACnB,yCAAyC;AACzC,QAAQ;AAER,8BAA8B;AAC9B,IAAI","sourcesContent":["import React, { ComponentType, memo, ReactElement, ReactNode } from 'react';\n\n\nexport function GuardDefined<T>({ value, children: render, fallback }: { value: T | null | undefined; children: (value: Exclude<T, null | undefined>) => ReactElement; fallback?: ReactNode; }): ReactElement {\n    if (isDefined(value)) {\n        return <>{render(value)}</>;\n    }\n\n    return <>{fallback}</>;\n}\n\ntype RequiredKeys<T> = { [K in keyof T]-?: Empty extends Pick<T, K> ? never : K }[keyof T];\ntype OptionalKeys<T> = { [K in keyof T]-?: Empty extends Pick<T, K> ? K : never }[keyof T];\ntype RequiredPart<T> = Pick<T, RequiredKeys<T>>;\ntype OptionalPart<T> = Pick<T, OptionalKeys<T>>;\n// eslint-disable-next-line @typescript-eslint/ban-types\ntype Empty = {};\ntype NullableKeys<T, ConsiderNulls extends boolean = true> = {\n    [K in keyof T]-?:\n    undefined extends T[K] ? K :\n    null extends T[K] ? (\n        ConsiderNulls extends true ? K : never\n    ) :\n    never\n}[keyof T];\ntype NonNullableKeys<T, IncludeNull extends boolean = true> = Exclude<keyof T, NullableKeys<T, IncludeNull>>;\n\ntype NullableRequiredValues<T> = {\n    [K in RequiredKeys<T>]: T[K] | undefined | null\n} & OptionalPart<T>;\ntype NullablePart<T, ConsiderNulls extends boolean = true> = Pick<T, NullableKeys<T, ConsiderNulls>>;\ntype NonNullablePart<T, ConsiderNulls extends boolean = true> = Pick<T, NonNullableKeys<T, ConsiderNulls>>;\n\n\n\ninterface GuardForProps<P, A> {\n\n}\ntype LeftOvers<P, A> =\n    A extends unknown ? P :\n    Omit<P, keyof A>;\ntype PP<T> = Empty extends T ? T : {\n    [P in keyof T]: Exclude<T[P], undefined>;\n};\n\n// function GuardFor<P>(props: GuardForProps<P> & NullableRequiredValues<P>): ReactElement;\nexport function GuardFor<P, A extends Partial<P>>({ target: Target, apply, children, ...props }: { target: ComponentType<P>; children?: ReactNode; apply: PP<A>; } & NullableRequiredValues<Omit<P, keyof A>>) {\n    const Child = apply ? partialApply(Target, apply as any) : Target;\n    if (Object.values(props).some(p => !p)) {\n        return <>{children}</>;\n    }\n    return <Child {...props as any as P} />;\n}\nexport function partialApply<P, Applied extends Partial<P>>(Target: ComponentType<P>, props: Applied) {\n    return memo(function Partial(p: Omit<P, keyof Applied>) {\n        return <Target {...{ ...props, ...p } as any as P} />;\n    });\n}\nexport function isDefined<T>(value: T | null | undefined): value is NonNullable<T> {\n    return value != null;\n}\n\n\n// export function Await<T>({ promise, children: render, fallback }: { promise: Promise<T>; children: (value: T) => ReactElement; fallback?: ReactNode; }): ReactElement {\n//     const [ready, result] = usePromise(promise);\n//     if (ready) {\n//         return <>{render(result!)}</>;\n//     }\n\n//     return <>{fallback}</>;\n// }\n"]}